<!--edit.wxml-->

<view class="container">
  <view class="page-body">
    <van-notify id="van-notify" />
    <van-dialog id="van-dialog" />
    <van-popup show="{{showTimePickerFlag}}" position="bottom" custom-style="height:45%">
      <van-datetime-picker id="datetime" type="datetime" value="{{currentDate}}"
       min-date="{{minDate}}" min-hour="{{7}}" max-hour="{{22}}" 
       formatter="{{formatter}}" filter="{{filter}}"
       bind:cancel="onTimePickerCancel"
       bind:confirm="onTimePickerConfirm"/>
    </van-popup>

    <view class="btns">
      <van-button disabled="{{expired}}" type="primary" size="large" bind:click="submitMatchInfo">{{publishText}}</van-button>
      <van-button disabled="{{publishNewMatch || expired}}" type="default" size="large" open-type="share">转发比赛</van-button>
    </view>

    <van-field clickable="{{true}}" readonly="{{subjectDisabled}}" value="{{matchInfo.subject}}" label="比赛主题" type="textarea" placeholder="输入比赛主题" autosize clearable="{{true}}" required="{{true}}" bind:input='getSubjectInput'/>

    <van-field is-link="{{!timeDisabled}}" readonly label="比赛时间" value="{{matchInfo.showTime}}" required="{{true}}" placeholder="选取比赛时间" bindtap="showTimePicker">
    </van-field>

    <van-field clickable="{{true}}" label="报名列表" disabled="{{expired}}" placeholder="报名" bind:input='getSUInput' />
    <view class="tag-list" hidden="{{!(matchInfo.signUpList.length)}}">
      <view class="tag-item" wx:for="{{matchInfo.signUpList}}" wx:key="key" wx:for-item="item">
        <van-tag id="signUp-tag" closeable="{{item.close}}" size="large" bind:close="onClose" type="success" data-index="{{index}}">
          {{item.content}}
        </van-tag>
      </view>
    </view>

    <van-field clickable="{{true}}" label="请假列表" disabled="{{expired}}" placeholder="请假" bind:input='getAFLInput' />
    <view class="tag-list" hidden="{{!(matchInfo.askForLeaveList.length)}}">
      <view class="tag-item" wx:for="{{matchInfo.askForLeaveList}}" wx:key="key" wx:for-item="item">
        <van-tag id="askForLeave-tag" closeable="{{item.close}}" size="large" bind:close="onClose" type="success" data-index="{{index}}">
          {{item.content}}
        </van-tag>
      </view>
    </view>

    <van-field readonly required="{{true}}" label="场地名称" placeholder="选取比赛位置" value="{{matchInfo.location.name}}" type="textarea" autosize bind:click-icon="chooseLocation">
      <view hidden="{{locationDisabled}}" slot="right-icon">
        <image class="" src="../../images/add.png" />
      </view>
    </van-field>
    <van-field readonly required="{{true}}" label="场地地址" placeholder="查看比赛位置" value="{{matchInfo.location.address}}" type="textarea" autosize bind:click-icon="openLocation">
      <view hidden="{{!matchInfo.location.address.length}}" slot="right-icon">
        <image src="../../images/info.png" />
      </view>
    </van-field>
    <map id="map" longitude="{{matchInfo.location.longitude}}" latitude="{{matchInfo.location.latitude}}" scale="14" markers="{{markers}}" show-compass="true" enable-zoom="false" enable-scroll='{{false}}'></map>

    <van-divider contentPosition="center">相约同城，球场竞技</van-divider>
  </view>
</view>